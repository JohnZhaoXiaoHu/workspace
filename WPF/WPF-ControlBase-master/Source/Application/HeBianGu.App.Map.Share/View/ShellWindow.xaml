<h:MenuWindowBase x:Class="HeBianGu.App.Map.ShellWindow"
                  xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
                  xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
                  xmlns:cl="clr-namespace:System.Collections;assembly=mscorlib"
                  xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
                  xmlns:h="https://github.com/HeBianGu"
                  xmlns:local="clr-namespace:HeBianGu.App.Map"
                  xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
                  xmlns:system="clr-namespace:System;assembly=mscorlib"
                  Title="ShellWindow"
                  Width="1300"
                  Height="800"
                  h:Cattach.Icon="&#xeb02;"
                  CaptionHeight="50"
                  DataContext="{Binding Source={StaticResource S.DataSource.Locator}, Path=ShellViewModel}"
                  mc:Ignorable="d">
    <!--<h:Cattach.CaptionRightTemplate>
        <ControlTemplate TargetType="Control">
            <Button h:Cattach.Icon="{x:Static h:Icons.Add}" Style="{DynamicResource {x:Static h:ButtonKeys.Icon}}" />
        </ControlTemplate>
    </h:Cattach.CaptionRightTemplate>-->

    <h:TransitionService.VisibleActions>
        <h:TransitionCollection>
            <h:AngleTransition EndAngle="720" StartAngle="720" />
            <h:ScaleTransition />
        </h:TransitionCollection>
    </h:TransitionService.VisibleActions>


    <h:MenuWindowBase.MenuContent>
        <Menu Style="{DynamicResource {x:Static h:MenuKeys.Window}}">
            <!--<Menu.Resources>
                <Style BasedOn="{StaticResource C.MenuItem.Default}" TargetType="MenuItem" />
            </Menu.Resources>-->
            <MenuItem Background="Transparent" Header="文件(F)">
                <MenuItem Command="{Binding RelayCommand}" Header="新建任务" IsEnabled="True" />
                <MenuItem Header="新建模板" IsEnabled="False" />
                <MenuItem Header="打开任务" />
                <MenuItem Header="保存任务" />
                <MenuItem Header="另存为" />
                <Separator Style="{DynamicResource {x:Static h:SeparatorKeys.Default}}" />
                <MenuItem Header="导出任务" />
                <MenuItem Header="导入任务" />
                <MenuItem Header="另存为模板" />
                <Separator Style="{DynamicResource {x:Static h:SeparatorKeys.Default}}" />
                <MenuItem Header="退出" />
            </MenuItem>

            <MenuItem Background="Transparent" Header="编辑(E)">
                <MenuItem Header="撤销" />
                <MenuItem Header="剪切" />
                <Separator Style="{DynamicResource {x:Static h:SeparatorKeys.Default}}" />
                <MenuItem Header="复制" />
                <MenuItem Header="粘贴" />
                <MenuItem Header="删除" />
            </MenuItem>

            <MenuItem Background="Transparent" Header="设置(S)">
                <MenuItem Header="滤波" IsEnabled="False" />
                <MenuItem Header="陷波" IsEnabled="False" />
            </MenuItem>

            <MenuItem Background="Transparent" Header="管理(S)">
                <MenuItem Header="用户管理" IsEnabled="True" />
                <MenuItem Header="地图管理" IsEnabled="True" />
                <Separator Style="{DynamicResource {x:Static h:SeparatorKeys.Default}}" />
                <MenuItem Header="主机管理" IsEnabled="True" />
                <MenuItem Header="设备模板管理" IsEnabled="True" />
            </MenuItem>

            <MenuItem Background="Transparent" Header="帮助(H)">
                <MenuItem Header="查看帮助" IsEnabled="True" />
                <MenuItem Header="注册产品" IsEnabled="True" />
                <MenuItem Header="技术支持" IsEnabled="True" />
                <MenuItem Header="软件升级" IsEnabled="True" />
                <Separator Style="{DynamicResource {x:Static h:SeparatorKeys.Default}}" />
                <MenuItem Header="检查更新" IsEnabled="True" />
                <MenuItem Header="关于" IsEnabled="True" />
            </MenuItem>
        </Menu>
    </h:MenuWindowBase.MenuContent>

    <Grid>
        <DockPanel>
            <DockPanel Height="{DynamicResource {x:Static h:SystemKeys.RowHeight}}"
                       Background="{DynamicResource {x:Static h:BrushKeys.Dark0_1}}"
                       DockPanel.Dock="Top"
                       LastChildFill="False">
                <Button Width="80"
                        Margin="2,0,0,0"
                        Command="{Binding RelayCommand}"
                        CommandParameter="Button.Click.Commit"
                        Content="开始"
                        IsEnabled="{Binding IsRunEnbel}" />
                <Button Width="80"
                        Margin="5,0,0,0"
                        Command="{Binding RelayCommand}"
                        Content="停止"
                        IsEnabled="{Binding IsStopEnbel}" />
                <Button Width="80" Margin="5,0,0,0" Content="保存" />

                <ToggleButton x:Name="tb_signal"
                              Width="80"
                              Margin="5,0,0,0"
                              Content="信号控制"
                              Style="{DynamicResource {x:Static h:ToggleButtonKeys.Rotate90}}"
                              Template="{DynamicResource {x:Static h:ControlTemplateKeys.ContentControlIcon}}" />

            </DockPanel>


            <DockPanel x:Name="dp_state"
                       Height="{DynamicResource {x:Static h:SystemKeys.ItemHeight}}"
                       VerticalAlignment="Bottom"
                       Background="{DynamicResource {x:Static h:BrushKeys.Dark0_1}}"
                       DockPanel.Dock="Bottom"
                       LastChildFill="False">
                <!--<h:TransitionService.VisibleActions>
                <h:TransitionCollection>
                    <h:TranslateTransition HiddenOrCollapsed="Hidden" />
                </h:TransitionCollection>
            </h:TransitionService.VisibleActions>-->

                <TextBlock Margin="10,0" VerticalAlignment="Center" Text="{Binding Message}" />
                <ProgressBar Width="200"
                             Height="20"
                             Margin="2,0"
                             Background="{DynamicResource {x:Static h:BrushKeys.WhiteOpactiy3}}"
                             DockPanel.Dock="Right"
                             Style="{DynamicResource {x:Static h:ProgressBarKeys.Handy}}"
                             Value="{Binding Percent}" />

                <h:Interaction.Triggers>
                    <h:EventTrigger EventName="MouseLeave">
                        <h:ChangePropertyAction PropertyName="StateVisble" TargetObject="{Binding}" Value="False" />
                    </h:EventTrigger>
                </h:Interaction.Triggers>
            </DockPanel>
            <Grid Background="{DynamicResource {x:Static h:BrushKeys.BackgroundDefault}}">
                <h:ImageCore Grid.ColumnSpan="4"
                             ImageSource="..\Resources\捕获.PNG"
                             Location="0,0,300,300"
                             OperateType="{Binding ElementName=list_selecttype, Path=SelectedItem}">
                    <!--<h:ImageCore ImageSource="..\Resources\捕获.PNG">-->
                    <h:ImageCore.Resources>
                        <Style TargetType="Ellipse">
                            <Setter Property="RenderTransform" Value="{DynamicResource {x:Static h:SystemKeys.TransformGroup}}" />
                            <Setter Property="RenderTransformOrigin" Value="0.5,0.5" />
                        </Style>
                    </h:ImageCore.Resources>

                    <h:Interaction.Behaviors>
                        <h:ImageBaseMouseWheelBehavior />
                        <h:ImageBaseMouseEnlargeBehavior />
                        <!--<h:ImageBaseMouseDragBehavior/>-->
                        <h:ImageBaseMouseRightDragBehavior />
                        <h:ImageBaseMouseSignBehavior />
                        <h:ImageBaseMouseBubbleBehavior />
                    </h:Interaction.Behaviors>

                    <h:ImageCore.InnerContent>

                        <Grid x:Name="grid_drag">
                            <ListBox Width="1000"
                                     Height="800"
                                     HorizontalAlignment="Center"
                                     VerticalAlignment="Stretch"
                                     h:Cattach.ItemHeight="Auto"
                                     ItemsSource="{Binding SelectedTask.Nodes}"
                                     SelectedItem="{Binding Source={StaticResource S.DataSource.Locator}, Path=ShellViewModel.SelectedNode}"
                                     Style="{DynamicResource {x:Static h:ListBoxKeys.Clear}}">
                                <ListBox.ItemTemplate>
                                    <DataTemplate>
                                        <Grid>
                                            <StackPanel x:Name="sp_circle" Visibility="Collapsed">
                                                <Grid DockPanel.Dock="Top">

                                                    <Border Width="200"
                                                            Height="200"
                                                            Background="Transparent"
                                                            BorderBrush="{DynamicResource {x:Static h:BrushKeys.Accent}}"
                                                            BorderThickness="2"
                                                            CornerRadius="100"
                                                            Cursor="ScrollAll" />

                                                    <ListBox h:Cattach.ItemHeight="Auto"
                                                             ItemsSource="{Binding Children}"
                                                             SelectedItem="{Binding Source={StaticResource S.DataSource.Locator}, Path=ShellViewModel.SelectedNode}"
                                                             Style="{DynamicResource {x:Static h:ListBoxKeys.Single}}">
                                                        <ListBox.ContextMenu>
                                                            <ContextMenu>
                                                                <MenuItem Command="{Binding Source={StaticResource S.DataSource.Locator}, Path=ShellViewModel.RelayCommand}"
                                                                          CommandParameter="新建任务"
                                                                          Header="添加设备"
                                                                          IsEnabled="True" />
                                                                <MenuItem Header="删除设备" IsEnabled="True" />
                                                            </ContextMenu>
                                                        </ListBox.ContextMenu>

                                                        <ListBox.ItemTemplate>
                                                            <DataTemplate>
                                                                <DockPanel>
                                                                    <TextBlock x:Name="tb_icon1"
                                                                               FontSize="10"
                                                                               Foreground="{DynamicResource {x:Static h:BrushKeys.Green}}"
                                                                               Style="{DynamicResource {x:Static h:TextBlockKeys.Icon}}"
                                                                               Text="&#xe81f;" />
                                                                    <TextBlock x:Name="tb_name1"
                                                                               Margin="10,0"
                                                                               Foreground="{DynamicResource {x:Static h:BrushKeys.Orange}}"
                                                                               Text="{Binding Value}" />
                                                                </DockPanel>
                                                            </DataTemplate>
                                                        </ListBox.ItemTemplate>

                                                        <ListBox.ItemsPanel>
                                                            <ItemsPanelTemplate>
                                                                <h:CirclePanel Len="80" />
                                                            </ItemsPanelTemplate>
                                                        </ListBox.ItemsPanel>

                                                        <h:Interaction.Triggers>
                                                            <h:EventTrigger EventName="SelectionChanged">
                                                                <h:InvokeCommandAction Command="{Binding Source={StaticResource S.DataSource.Locator}, Path=ShellViewModel.RelayCommand}" CommandParameter="SelectionChanged.ShowProperty" />
                                                            </h:EventTrigger>
                                                        </h:Interaction.Triggers>
                                                    </ListBox>

                                                    <TextBlock x:Name="tb_icon"
                                                               Cursor="ScrollAll"
                                                               FontSize="42"
                                                               FontWeight="Black"
                                                               Foreground="{DynamicResource {x:Static h:BrushKeys.Accent}}"
                                                               Style="{DynamicResource {x:Static h:TextBlockKeys.Icon}}"
                                                               Text="&#xe6f9;" />

                                                    <TextBlock x:Name="tb_name"
                                                               VerticalAlignment="Top"
                                                               Cursor="Hand"
                                                               Foreground="{DynamicResource {x:Static h:BrushKeys.Accent}}"
                                                               Text="{Binding Value}">
                                                        <h:Interaction.Triggers>
                                                            <h:EventTrigger EventName="MouseDown">
                                                                <h:InvokeCommandAction Command="{Binding Source={StaticResource S.DataSource.Locator}, Path=ShellViewModel.RelayCommand}" CommandParameter="SelectionChanged.Server.ShowProperty" />
                                                            </h:EventTrigger>
                                                        </h:Interaction.Triggers>

                                                        <h:Interaction.Behaviors>
                                                            <h:SelectListBoxItemElementBehavior />
                                                        </h:Interaction.Behaviors>
                                                    </TextBlock>

                                                    <CheckBox x:Name="tb"
                                                              Margin="5,0"
                                                              HorizontalAlignment="Right"
                                                              VerticalAlignment="Center"
                                                              h:Cattach.CheckedIcon="&#xe863;"
                                                              h:Cattach.UncheckedIcon="&#xe862;"
                                                              Style="{DynamicResource {x:Static h:CheckBoxKeys.Single}}"
                                                              Visibility="Collapsed" />

                                                    <Grid.ContextMenu>
                                                        <ContextMenu>
                                                            <MenuItem Command="{Binding Source={StaticResource S.DataSource.Locator}, Path=ShellViewModel.RelayCommand}"
                                                                      CommandParameter="新建任务"
                                                                      Header="添加设备"
                                                                      IsEnabled="True" />
                                                            <MenuItem Header="删除" IsEnabled="True" />
                                                            <Separator Style="{DynamicResource {x:Static h:SeparatorKeys.Default}}" />
                                                            <MenuItem Header="信号检测" IsEnabled="True" />
                                                            <MenuItem Header="强度调整" IsEnabled="True" />
                                                            <Separator Style="{DynamicResource {x:Static h:SeparatorKeys.Default}}" />
                                                            <MenuItem Header="关闭输出" IsEnabled="True" />
                                                            <MenuItem Header="显示/隐藏" IsEnabled="True" />
                                                        </ContextMenu>
                                                    </Grid.ContextMenu>
                                                </Grid>

                                                <ListBox Width="200"
                                                         MaxHeight="130"
                                                         HorizontalAlignment="Left"
                                                         h:Cattach.ItemHeight="Auto"
                                                         h:TransitionService.IsVisible="{Binding ElementName=tb, Path=IsChecked}"
                                                         Background="{DynamicResource {x:Static h:BrushKeys.AccentMouseOverForeground}}"
                                                         ItemsSource="{Binding Children}"
                                                         SelectedItem="{Binding SelectedEquipment}"
                                                         Style="{DynamicResource {x:Static h:ListBoxKeys.Single}}">
                                                    <ListBox.ContextMenu>
                                                        <ContextMenu>
                                                            <MenuItem Command="{Binding Source={StaticResource S.DataSource.Locator}, Path=ShellViewModel.RelayCommand}"
                                                                      CommandParameter="新建任务"
                                                                      Header="添加设备"
                                                                      IsEnabled="True" />
                                                            <MenuItem Header="删除设备" IsEnabled="True" />
                                                        </ContextMenu>
                                                    </ListBox.ContextMenu>

                                                    <ListBox.ItemTemplate>
                                                        <DataTemplate>
                                                            <DockPanel>
                                                                <TextBlock x:Name="tb_icon1"
                                                                           FontSize="10"
                                                                           Foreground="{DynamicResource {x:Static h:BrushKeys.ForegroundWhite}}"
                                                                           Style="{DynamicResource {x:Static h:TextBlockKeys.Icon}}"
                                                                           Text="&#xe81f;" />
                                                                <TextBlock x:Name="tb_name1"
                                                                           Margin="10,0"
                                                                           Foreground="{DynamicResource {x:Static h:BrushKeys.ForegroundWhite}}"
                                                                           Text="{Binding Value}" />
                                                                <TextBlock Foreground="{DynamicResource {x:Static h:BrushKeys.ForegroundWhite}}" Text="{Binding Value1}" />
                                                            </DockPanel>
                                                        </DataTemplate>
                                                    </ListBox.ItemTemplate>
                                                    <h:Interaction.Triggers>
                                                        <h:EventTrigger EventName="SelectionChanged">
                                                            <h:InvokeCommandAction Command="{Binding Source={StaticResource S.DataSource.Locator}, Path=ShellViewModel.RelayCommand}" CommandParameter="SelectionChanged.ShowProperty" />
                                                        </h:EventTrigger>
                                                    </h:Interaction.Triggers>
                                                </ListBox>

                                                <h:Interaction.Behaviors>
                                                    <h:MouseDragElementBehavior ParentElement="{Binding ElementName=grid_drag}" />
                                                </h:Interaction.Behaviors>
                                            </StackPanel>

                                            <Grid x:Name="sp_sector"
                                                  Width="500"
                                                  Height="500"
                                                  ClipToBounds="False">

                                                <h:Sector x:Name="st"
                                                          HorizontalAlignment="Left"
                                                          VerticalAlignment="Top"
                                                          AllowDrop="True"
                                                          Cursor="ScrollAll"
                                                          End="{Binding Double2}"
                                                          Fill="{DynamicResource {x:Static h:BrushKeys.AccentMouseOverForeground}}"
                                                          Len="{Binding Int2}"
                                                          OffSet="{Binding Double3}"
                                                          Start="{Binding Double1}"
                                                          Tag="{Binding}">
                                                    <h:Interaction.Triggers>
                                                        <h:EventTrigger EventName="Drop">
                                                            <h:InvokeCommandAction Command="{Binding Source={StaticResource S.DataSource.Locator}, Path=ShellViewModel.RelayCommand}" PassEventArgsToCommand="True" />
                                                        </h:EventTrigger>
                                                    </h:Interaction.Triggers>
                                                </h:Sector>

                                                <ListBox Margin="-130"
                                                         HorizontalAlignment="Left"
                                                         VerticalAlignment="Top"
                                                         h:Cattach.ItemHeight="Auto"
                                                         ItemsSource="{Binding Children}"
                                                         SelectedItem="{Binding Source={StaticResource S.DataSource.Locator}, Path=ShellViewModel.SelectedNode}"
                                                         Style="{DynamicResource {x:Static h:ListBoxKeys.Default}}">
                                                    <h:Interaction.Behaviors>
                                                        <h:ListDropBlendBehavior DragGroup="Equipment" />
                                                    </h:Interaction.Behaviors>
                                                    <ListBox.ContextMenu>
                                                        <ContextMenu>
                                                            <MenuItem Command="{Binding Source={StaticResource S.DataSource.Locator}, Path=ShellViewModel.RelayCommand}"
                                                                      CommandParameter="新建任务"
                                                                      Header="添加设备"
                                                                      IsEnabled="True" />
                                                            <MenuItem Header="删除设备" IsEnabled="True" />
                                                        </ContextMenu>
                                                    </ListBox.ContextMenu>

                                                    <ListBox.ItemTemplate>
                                                        <DataTemplate>
                                                            <DockPanel>
                                                                <TextBlock x:Name="tb_name1"
                                                                           Margin="0,0,10,0"
                                                                           FontWeight="Black"
                                                                           Text="{Binding Value}" />
                                                            </DockPanel>
                                                        </DataTemplate>
                                                    </ListBox.ItemTemplate>
                                                    <ListBox.ItemsPanel>
                                                        <ItemsPanelTemplate>
                                                            <h:CirclePanel Margin="50" DisplayCount="10" Len="100" />

                                                        </ItemsPanelTemplate>
                                                    </ListBox.ItemsPanel>

                                                    <h:Interaction.Triggers>
                                                        <h:EventTrigger EventName="SelectionChanged">
                                                            <h:InvokeCommandAction Command="{Binding Source={StaticResource S.DataSource.Locator}, Path=ShellViewModel.RelayCommand}" CommandParameter="SelectionChanged.ShowProperty" />
                                                        </h:EventTrigger>
                                                    </h:Interaction.Triggers>

                                                </ListBox>

                                                <TextBlock x:Name="tb_icon1"
                                                           HorizontalAlignment="Left"
                                                           VerticalAlignment="Top"
                                                           Cursor="ScrollAll"
                                                           FontSize="42"
                                                           FontWeight="Black"
                                                           Foreground="{DynamicResource {x:Static h:BrushKeys.Accent}}"
                                                           Style="{DynamicResource {x:Static h:TextBlockKeys.Icon}}"
                                                           Text="&#xe823;" />

                                                <TextBlock x:Name="tb_name1"
                                                           Margin="20,40"
                                                           HorizontalAlignment="Left"
                                                           VerticalAlignment="Top"
                                                           Cursor="Hand"
                                                           FontWeight="Black"
                                                           Foreground="Black"
                                                           Text="{Binding Value}">
                                                    <TextBlock.Effect>
                                                        <DropShadowEffect BlurRadius="10" ShadowDepth="0" Color="White" />
                                                    </TextBlock.Effect>
                                                    <h:Interaction.Triggers>
                                                        <h:EventTrigger EventName="MouseDown">
                                                            <h:InvokeCommandAction Command="{Binding Source={StaticResource S.DataSource.Locator}, Path=ShellViewModel.RelayCommand}" CommandParameter="SelectionChanged.Server.ShowProperty" />
                                                        </h:EventTrigger>
                                                    </h:Interaction.Triggers>

                                                    <h:Interaction.Behaviors>
                                                        <h:SelectListBoxItemElementBehavior />
                                                    </h:Interaction.Behaviors>
                                                </TextBlock>

                                                <Grid.ContextMenu>
                                                    <ContextMenu>
                                                        <MenuItem Command="{Binding Source={StaticResource S.DataSource.Locator}, Path=ShellViewModel.RelayCommand}"
                                                                  CommandParameter="新建任务"
                                                                  Header="添加设备"
                                                                  IsEnabled="True" />
                                                        <MenuItem Header="删除" IsEnabled="True" />
                                                        <Separator Style="{DynamicResource {x:Static h:SeparatorKeys.Default}}" />
                                                        <MenuItem Header="信号检测" IsEnabled="True" />
                                                        <MenuItem Header="强度调整" IsEnabled="True" />
                                                        <Separator Style="{DynamicResource {x:Static h:SeparatorKeys.Default}}" />
                                                        <MenuItem Header="关闭输出" IsEnabled="True" />
                                                        <MenuItem Header="显示/隐藏" IsEnabled="True" />
                                                    </ContextMenu>
                                                </Grid.ContextMenu>
                                            </Grid>

                                            <h:Interaction.Behaviors>
                                                <h:MouseDragElementBehavior ParentElement="{Binding ElementName=grid_drag}" />
                                            </h:Interaction.Behaviors>
                                        </Grid>

                                        <DataTemplate.Triggers>
                                            <DataTrigger Binding="{Binding RelativeSource={RelativeSource AncestorType=ListBoxItem}, Path=IsSelected}" Value="True">
                                                <Setter TargetName="tb_icon1" Property="Foreground" Value="{DynamicResource {x:Static h:BrushKeys.Red}}" />
                                                <Setter TargetName="st" Property="Fill">
                                                    <Setter.Value>
                                                        <SolidColorBrush Opacity="0.5" Color="Red" />
                                                    </Setter.Value>
                                                </Setter>
                                            </DataTrigger>

                                            <DataTrigger Binding="{Binding Value9}" Value="1">
                                                <Setter TargetName="sp_sector" Property="Visibility" Value="Collapsed" />
                                                <Setter TargetName="sp_circle" Property="Visibility" Value="Visible" />
                                            </DataTrigger>

                                            <DataTrigger Binding="{Binding Value9}" Value="2">
                                                <Setter TargetName="sp_circle" Property="Visibility" Value="Collapsed" />
                                                <Setter TargetName="sp_sector" Property="Visibility" Value="Visible" />
                                            </DataTrigger>
                                        </DataTemplate.Triggers>
                                    </DataTemplate>
                                </ListBox.ItemTemplate>

                                <ListBox.ItemsPanel>
                                    <ItemsPanelTemplate>
                                        <h:CirclePanel IsAnimation="False" IsItemsHost="True" Len="350" />
                                    </ItemsPanelTemplate>
                                </ListBox.ItemsPanel>

                                <h:Interaction.Behaviors>
                                    <h:ListDropBlendBehavior DragGroup="Server" />
                                </h:Interaction.Behaviors>
                            </ListBox>
                        </Grid>

                    </h:ImageCore.InnerContent>

                </h:ImageCore>

                <h:Drawer Grid.ColumnSpan="22"
                          Padding="0"
                          HorizontalAlignment="Left"
                          h:Cattach.Icon="模"
                          Background="Transparent"
                          Header="模板列表"
                          IsExpanded="False"
                          Style="{DynamicResource {x:Static h:Drawer.LeftClearKey}}">
                    <h:TransitionService.VisibleActions>
                        <h:TransitionCollection>
                            <h:TranslateTransition StartPoint="-300,0" EndPoint="-200,0" />
                        </h:TransitionCollection>
                    </h:TransitionService.VisibleActions>

                    <GroupBox Width="350"
                              Padding="0"
                              h:Cattach.CaptionForeground="{DynamicResource {x:Static h:BrushKeys.ForegroundWhite}}"
                              Background="{DynamicResource {x:Static h:BrushKeys.AccentOpacity5}}"
                              Header="设备模板"
                              Style="{DynamicResource {x:Static h:GroupBoxKeys.Close}}">
                        <DockPanel>
                            <h:Row DockPanel.Dock="Top">
                                <TextBox Grid.ColumnSpan="22"
                                         Margin="5,0"
                                         h:Cattach.FocusBackground="{DynamicResource {x:Static h:BrushKeys.ForegroundWhite}}"
                                         h:Cattach.Icon="&#xe787;"
                                         h:Cattach.MouseOverBackground="{DynamicResource {x:Static h:BrushKeys.ForegroundWhite}}"
                                         h:Cattach.Watermark="请输入筛选条件"
                                         Style="{DynamicResource {x:Static h:TextBoxKeys.Search}}" />
                            </h:Row>
                            <DockPanel Grid.Row="1" DockPanel.Dock="Bottom" />

                            <ListBox Grid.Row="1"
                                     h:Cattach.ItemBackground="Transparent"
                                     h:Cattach.MouseOverBackground="{DynamicResource {x:Static h:BrushKeys.WhiteOpactiy2}}"
                                     h:Cattach.SelectBackground="{DynamicResource {x:Static h:BrushKeys.WhiteOpactiy4}}"
                                     AllowDrop="True"
                                     Background="Transparent"
                                     ItemTemplate="{StaticResource C.TestViewModel.Item.Many}"
                                     ItemsSource="{Binding EquipmentTemplates}"
                                     SelectedItem="{Binding SelectedEquipment}"
                                     Style="{DynamicResource {x:Static h:ListBoxKeys.AllowDrag}}">
                                <ListBox.ContextMenu>
                                    <ContextMenu>
                                        <MenuItem CommandParameter="新建任务" Header="添加" IsEnabled="True" />
                                        <MenuItem Header="删除" IsEnabled="True" />
                                    </ContextMenu>
                                </ListBox.ContextMenu>

                                <ListBox.GroupStyle>
                                    <GroupStyle ContainerStyle="{StaticResource S.GroupItem.Transparent}">
                                        <GroupStyle.Panel>
                                            <ItemsPanelTemplate>
                                                <DataGridRowsPresenter />
                                            </ItemsPanelTemplate>
                                        </GroupStyle.Panel>
                                    </GroupStyle>
                                </ListBox.GroupStyle>

                                <h:Interaction.Triggers>
                                    <h:EventTrigger EventName="SelectionChanged">
                                        <h:InvokeCommandAction Command="{Binding RelayCommand}" CommandParameter="SelectionChanged.ShowProperty" />
                                    </h:EventTrigger>
                                </h:Interaction.Triggers>
                            </ListBox>

                        </DockPanel>
                    </GroupBox>
                </h:Drawer>

                <h:Drawer Grid.ColumnSpan="22"
                          Padding="0"
                          VerticalContentAlignment="Stretch"
                          h:Cattach.Icon="任"
                          Background="Transparent"
                          Header="列表"
                          IsExpanded="True"
                          Style="{DynamicResource {x:Static h:Drawer.RightClearKey}}">
                    <h:TransitionService.VisibleActions>
                        <h:TransitionCollection>
                            <h:TranslateTransition StartPoint="300,0" EndPoint="200,0" />
                        </h:TransitionCollection>
                    </h:TransitionService.VisibleActions>

                    <Grid>
                        <UniformGrid Width="350" Rows="2">
                            <GroupBox Padding="0"
                                      h:Cattach.CaptionForeground="{DynamicResource {x:Static h:BrushKeys.ForegroundWhite}}"
                                      Background="{DynamicResource {x:Static h:BrushKeys.AccentOpacity5}}"
                                      Header="{Binding SelectedTask.Value}"
                                      Style="{DynamicResource {x:Static h:GroupBoxKeys.Close}}">

                                <DockPanel>
                                    <h:Row DockPanel.Dock="Top">
                                        <TextBox Grid.ColumnSpan="22"
                                                 Margin="5,0"
                                                 h:Cattach.FocusBackground="{DynamicResource {x:Static h:BrushKeys.ForegroundWhite}}"
                                                 h:Cattach.Icon="&#xe787;"
                                                 h:Cattach.MouseOverBackground="{DynamicResource {x:Static h:BrushKeys.ForegroundWhite}}"
                                                 h:Cattach.Watermark="请输入筛选条件"
                                                 Style="{DynamicResource {x:Static h:TextBoxKeys.Search}}" />
                                    </h:Row>
                                    <TreeView x:Name="tv"
                                              HorizontalAlignment="Stretch"
                                              h:Cattach.MouseOverBackground="{DynamicResource {x:Static h:BrushKeys.WhiteOpactiy2}}"
                                              h:Cattach.SelectBackground="{DynamicResource {x:Static h:BrushKeys.WhiteOpactiy5}}"
                                              h:Cattach.UseSearch="False"
                                              Background="Transparent"
                                              BorderThickness="0"
                                              Foreground="{DynamicResource {x:Static h:BrushKeys.ForegroundWhite}}"
                                              ItemsSource="{Binding SelectedTask.Nodes}">
                                        <TreeView.Resources>
                                            <HierarchicalDataTemplate DataType="{x:Type local:ServerViewModel}" ItemsSource="{Binding Children}">
                                                <Grid x:Name="grid"
                                                      HorizontalAlignment="Stretch"
                                                      VerticalAlignment="Stretch"
                                                      Background="Transparent"
                                                      TextBlock.Foreground="{Binding RelativeSource={RelativeSource AncestorType=ListBoxItem}, Path=Foreground}">
                                                    <Grid.ContextMenu>
                                                        <ContextMenu>
                                                            <MenuItem CommandParameter="新建任务" Header="添加位置" IsEnabled="True" />
                                                            <MenuItem CommandParameter="新建任务" Header="添加设备" IsEnabled="True" />
                                                            <MenuItem Header="清空设备" />
                                                            <MenuItem Header="删除位置" IsEnabled="True" />
                                                            <Separator Style="{DynamicResource {x:Static h:SeparatorKeys.Default}}" />
                                                            <MenuItem Header="信号检测" IsEnabled="True" />
                                                            <MenuItem Header="强度调整" IsEnabled="True" />
                                                            <MenuItem Header="关闭输出" IsEnabled="True" />
                                                            <MenuItem Header="显示/隐藏" IsEnabled="True" />
                                                            <Separator Style="{DynamicResource {x:Static h:SeparatorKeys.Default}}" />
                                                            <MenuItem Header="保存模板" IsEnabled="True" />
                                                        </ContextMenu>
                                                    </Grid.ContextMenu>

                                                    <Grid.ColumnDefinitions>
                                                        <ColumnDefinition Width="Auto" />
                                                        <ColumnDefinition />
                                                        <ColumnDefinition />
                                                        <ColumnDefinition Width="Auto" />
                                                        <ColumnDefinition Width="Auto" />
                                                    </Grid.ColumnDefinitions>

                                                    <TextBlock Grid.Row="1"
                                                               Grid.Column="0"
                                                               VerticalAlignment="Center"
                                                               FontSize="15"
                                                               Foreground="{DynamicResource {x:Static h:BrushKeys.ForegroundWhite}}"
                                                               Style="{DynamicResource {x:Static h:TextBlockKeys.Icon}}"
                                                               Text="&#xe73b;"
                                                               ToolTip="{Binding Value1}" />

                                                    <TextBlock Grid.Row="1"
                                                               Grid.Column="1"
                                                               Margin="10,0"
                                                               VerticalAlignment="Center"
                                                               Foreground="{DynamicResource {x:Static h:BrushKeys.ForegroundWhite}}"
                                                               Text="{Binding Value}"
                                                               ToolTip="{Binding Value1}" />

                                                    <Button Grid.Column="3"
                                                            h:Cattach.Icon="+"
                                                            h:Cattach.IconSize="18"
                                                            Foreground="{DynamicResource {x:Static h:BrushKeys.ForegroundWhite}}"
                                                            Style="{DynamicResource {x:Static h:ButtonKeys.Transparent}}" />

                                                    <Button x:Name="btn_close"
                                                            Grid.Column="4"
                                                            h:Cattach.IconSize="12"
                                                            h:Cattach.MouseOverForeground="{DynamicResource {x:Static h:BrushKeys.Red}}"
                                                            Foreground="{DynamicResource {x:Static h:BrushKeys.ForegroundWhite}}"
                                                            Style="{DynamicResource {x:Static h:ButtonKeys.Close}}" />

                                                </Grid>
                                            </HierarchicalDataTemplate>

                                            <HierarchicalDataTemplate DataType="{x:Type h:TestViewModel}" ItemsSource="{Binding Children}">
                                                <Grid x:Name="grid"
                                                      HorizontalAlignment="Stretch"
                                                      Background="Transparent"
                                                      TextBlock.Foreground="{Binding RelativeSource={RelativeSource AncestorType=ListBoxItem}, Path=Foreground}">
                                                    <Grid.RowDefinitions>
                                                        <RowDefinition />
                                                    </Grid.RowDefinitions>

                                                    <Grid.ColumnDefinitions>
                                                        <ColumnDefinition Width="Auto" />
                                                        <ColumnDefinition />
                                                        <ColumnDefinition />
                                                        <ColumnDefinition />
                                                        <ColumnDefinition Width="Auto" />
                                                    </Grid.ColumnDefinitions>

                                                    <TextBlock Grid.Row="1"
                                                               Grid.Column="0"
                                                               Margin="10,0"
                                                               VerticalAlignment="Center"
                                                               FontSize="12"
                                                               Foreground="{DynamicResource {x:Static h:BrushKeys.ForegroundWhite}}"
                                                               Style="{DynamicResource {x:Static h:TextBlockKeys.Icon}}"
                                                               Text="&#xe861;"
                                                               ToolTip="{Binding Value1}" />

                                                    <TextBlock Grid.Row="1"
                                                               Grid.Column="1"
                                                               VerticalAlignment="Center"
                                                               Foreground="{DynamicResource {x:Static h:BrushKeys.ForegroundWhite}}"
                                                               Text="{Binding Value}"
                                                               ToolTip="{Binding Value1}" />

                                                    <Button x:Name="btn_close"
                                                            Grid.Column="4"
                                                            h:Cattach.IconSize="12"
                                                            h:Cattach.MouseOverForeground="{DynamicResource {x:Static h:BrushKeys.Red}}"
                                                            Foreground="{DynamicResource {x:Static h:BrushKeys.ForegroundWhite}}"
                                                            Style="{DynamicResource {x:Static h:ButtonKeys.Close}}" />
                                                </Grid>

                                            </HierarchicalDataTemplate>

                                            <HierarchicalDataTemplate DataType="{x:Type local:EquipmentViewModel}" ItemsSource="{Binding Children}">
                                                <Grid x:Name="grid"
                                                      HorizontalAlignment="Stretch"
                                                      Background="Transparent"
                                                      TextBlock.Foreground="{Binding RelativeSource={RelativeSource AncestorType=ListBoxItem}, Path=Foreground}">
                                                    <Grid.ContextMenu>
                                                        <ContextMenu>
                                                            <MenuItem CommandParameter="新建任务" Header="添加" IsEnabled="True" />
                                                            <MenuItem Header="删除" IsEnabled="True" />
                                                            <MenuItem Header="复制" IsEnabled="True" />
                                                            <MenuItem Header="粘贴" IsEnabled="True" />
                                                            <Separator Style="{DynamicResource {x:Static h:SeparatorKeys.Default}}" />
                                                            <MenuItem Header="保存模板" IsEnabled="True" />
                                                        </ContextMenu>
                                                    </Grid.ContextMenu>

                                                    <Grid.ColumnDefinitions>
                                                        <ColumnDefinition Width="Auto" />
                                                        <ColumnDefinition />
                                                        <ColumnDefinition />
                                                        <ColumnDefinition />
                                                        <ColumnDefinition Width="Auto" />
                                                    </Grid.ColumnDefinitions>

                                                    <TextBlock Grid.Row="1"
                                                               Grid.Column="0"
                                                               Margin="0,0,10,0"
                                                               VerticalAlignment="Center"
                                                               FontSize="12"
                                                               Foreground="{DynamicResource {x:Static h:BrushKeys.ForegroundWhite}}"
                                                               Style="{DynamicResource {x:Static h:TextBlockKeys.Icon}}"
                                                               Text="&#xe861;"
                                                               ToolTip="{Binding Value1}" />

                                                    <TextBlock Grid.Row="1"
                                                               Grid.Column="1"
                                                               VerticalAlignment="Center"
                                                               Foreground="{DynamicResource {x:Static h:BrushKeys.ForegroundWhite}}"
                                                               Text="{Binding Value}"
                                                               ToolTip="{Binding Value1}" />

                                                    <Button x:Name="btn_close"
                                                            Grid.Column="4"
                                                            h:Cattach.IconSize="12"
                                                            h:Cattach.MouseOverForeground="{DynamicResource {x:Static h:BrushKeys.Red}}"
                                                            Foreground="{DynamicResource {x:Static h:BrushKeys.ForegroundWhite}}"
                                                            Style="{DynamicResource {x:Static h:ButtonKeys.Close}}" />
                                                </Grid>
                                            </HierarchicalDataTemplate>

                                            <HierarchicalDataTemplate DataType="{x:Type local:TaskViewModel}" ItemsSource="{Binding Children}">
                                                <Grid x:Name="grid"
                                                      HorizontalAlignment="Stretch"
                                                      Background="Transparent"
                                                      TextBlock.Foreground="{Binding RelativeSource={RelativeSource AncestorType=ListBoxItem}, Path=Foreground}">
                                                    <Grid.ContextMenu>
                                                        <ContextMenu>
                                                            <MenuItem Header="生成" IsEnabled="True" />
                                                            <MenuItem CommandParameter="新建任务" Header="添加" IsEnabled="True" />
                                                            <MenuItem Header="打开" IsEnabled="True" />
                                                            <MenuItem Header="复制" IsEnabled="True" />
                                                            <MenuItem Header="粘贴" IsEnabled="True" />
                                                            <MenuItem Header="删除" IsEnabled="True" />
                                                            <Separator Style="{DynamicResource {x:Static h:SeparatorKeys.Default}}" />
                                                            <MenuItem Header="导入" IsEnabled="True" />
                                                            <MenuItem Header="导出" IsEnabled="True" />
                                                            <Separator Style="{DynamicResource {x:Static h:SeparatorKeys.Default}}" />
                                                            <MenuItem CommandParameter="新建任务" Header="添加设备" IsEnabled="True" />
                                                            <MenuItem Header="清空设备" />
                                                            <Separator Style="{DynamicResource {x:Static h:SeparatorKeys.Default}}" />
                                                            <MenuItem CommandParameter="新建任务" Header="添加发生器" IsEnabled="True" />
                                                            <MenuItem Header="清空发生器" />
                                                            <Separator Style="{DynamicResource {x:Static h:SeparatorKeys.Default}}" />
                                                            <MenuItem Header="保存模板" IsEnabled="True" />
                                                        </ContextMenu>
                                                    </Grid.ContextMenu>

                                                    <Grid.ColumnDefinitions>
                                                        <ColumnDefinition Width="Auto" />
                                                        <ColumnDefinition />
                                                        <ColumnDefinition />
                                                        <ColumnDefinition Width="Auto" />
                                                        <ColumnDefinition Width="Auto" />
                                                    </Grid.ColumnDefinitions>

                                                    <TextBlock Grid.Row="1"
                                                               Grid.Column="0"
                                                               Margin="10,0"
                                                               VerticalAlignment="Center"
                                                               FontSize="12"
                                                               Foreground="{DynamicResource {x:Static h:BrushKeys.ForegroundWhite}}"
                                                               Style="{DynamicResource {x:Static h:TextBlockKeys.Icon}}"
                                                               Text="&#xe861;"
                                                               ToolTip="{Binding Value1}" />

                                                    <TextBlock Grid.Row="1"
                                                               Grid.Column="1"
                                                               VerticalAlignment="Center"
                                                               Foreground="{DynamicResource {x:Static h:BrushKeys.ForegroundWhite}}"
                                                               Text="{Binding Value}"
                                                               ToolTip="{Binding Value1}" />

                                                    <Button Grid.Column="3"
                                                            h:Cattach.Icon="+"
                                                            h:Cattach.IconSize="18"
                                                            Foreground="{DynamicResource {x:Static h:BrushKeys.ForegroundWhite}}"
                                                            Style="{DynamicResource {x:Static h:ButtonKeys.Transparent}}" />

                                                    <Button x:Name="btn_close"
                                                            Grid.Column="4"
                                                            h:Cattach.IconSize="12"
                                                            h:Cattach.MouseOverForeground="{DynamicResource {x:Static h:BrushKeys.Red}}"
                                                            Foreground="{DynamicResource {x:Static h:BrushKeys.ForegroundWhite}}"
                                                            Style="{DynamicResource {x:Static h:ButtonKeys.Close}}" />
                                                </Grid>
                                            </HierarchicalDataTemplate>

                                            <HierarchicalDataTemplate DataType="{x:Type local:ServerGroupViewModel}" ItemsSource="{Binding Children}">
                                                <Grid x:Name="grid"
                                                      HorizontalAlignment="Stretch"
                                                      Background="Transparent"
                                                      TextBlock.Foreground="{Binding RelativeSource={RelativeSource AncestorType=ListBoxItem}, Path=Foreground}">
                                                    <Grid.ContextMenu>
                                                        <ContextMenu>
                                                            <MenuItem CommandParameter="新建任务" Header="添加" IsEnabled="True" />
                                                            <MenuItem Header="清空" IsEnabled="True" />
                                                        </ContextMenu>
                                                    </Grid.ContextMenu>

                                                    <Grid.ColumnDefinitions>
                                                        <ColumnDefinition Width="Auto" />
                                                        <ColumnDefinition />
                                                        <ColumnDefinition />
                                                        <ColumnDefinition Width="Auto" />
                                                        <ColumnDefinition Width="Auto" />
                                                    </Grid.ColumnDefinitions>

                                                    <TextBlock Grid.Row="1"
                                                               Grid.Column="0"
                                                               Margin="10,0"
                                                               VerticalAlignment="Center"
                                                               FontSize="12"
                                                               Foreground="{DynamicResource {x:Static h:BrushKeys.ForegroundWhite}}"
                                                               Style="{DynamicResource {x:Static h:TextBlockKeys.Icon}}"
                                                               Text="&#xe861;"
                                                               ToolTip="{Binding Value1}" />

                                                    <TextBlock Grid.Row="1"
                                                               Grid.Column="1"
                                                               VerticalAlignment="Center"
                                                               Foreground="{DynamicResource {x:Static h:BrushKeys.ForegroundWhite}}"
                                                               Text="{Binding Value}"
                                                               ToolTip="{Binding Value1}" />

                                                    <!--<Button x:Name="btn_add" Grid.Column="3" Style="{DynamicResource {x:Static h:ButtonKeys.Close}}"
                                                   IconSize="12" MouseOverForeground="{DynamicResource {x:Static h:BrushKeys.Red}}"
                                                   Foreground="{DynamicResource {x:Static h:BrushKeys.ForegroundWhite}}"/>-->

                                                    <Button Grid.Column="3"
                                                            h:Cattach.Icon="+"
                                                            h:Cattach.IconSize="18"
                                                            Foreground="{DynamicResource {x:Static h:BrushKeys.ForegroundWhite}}"
                                                            Style="{DynamicResource {x:Static h:ButtonKeys.Transparent}}" />

                                                    <Button x:Name="btn_close"
                                                            Grid.Column="4"
                                                            h:Cattach.IconSize="12"
                                                            h:Cattach.MouseOverForeground="{DynamicResource {x:Static h:BrushKeys.Red}}"
                                                            Foreground="{DynamicResource {x:Static h:BrushKeys.ForegroundWhite}}"
                                                            Style="{DynamicResource {x:Static h:ButtonKeys.Close}}" />
                                                </Grid>
                                            </HierarchicalDataTemplate>

                                            <HierarchicalDataTemplate DataType="{x:Type local:EquipmentGroupViewModel}" ItemsSource="{Binding Children}">
                                                <Grid x:Name="grid"
                                                      HorizontalAlignment="Stretch"
                                                      Background="Transparent"
                                                      TextBlock.Foreground="{Binding RelativeSource={RelativeSource AncestorType=ListBoxItem}, Path=Foreground}">
                                                    <Grid.ContextMenu>
                                                        <ContextMenu>
                                                            <MenuItem CommandParameter="新建任务" Header="添加" IsEnabled="True" />
                                                            <MenuItem Header="清空" IsEnabled="True" />
                                                        </ContextMenu>
                                                    </Grid.ContextMenu>

                                                    <Grid.ColumnDefinitions>
                                                        <ColumnDefinition Width="Auto" />
                                                        <ColumnDefinition />
                                                        <ColumnDefinition />
                                                        <ColumnDefinition Width="Auto" />
                                                        <ColumnDefinition Width="Auto" />
                                                    </Grid.ColumnDefinitions>

                                                    <TextBlock Grid.Row="1"
                                                               Grid.Column="0"
                                                               Margin="10,0"
                                                               VerticalAlignment="Center"
                                                               FontSize="12"
                                                               Foreground="{DynamicResource {x:Static h:BrushKeys.ForegroundWhite}}"
                                                               Style="{DynamicResource {x:Static h:TextBlockKeys.Icon}}"
                                                               Text="&#xe861;"
                                                               ToolTip="{Binding Value1}" />

                                                    <TextBlock Grid.Row="1"
                                                               Grid.Column="1"
                                                               VerticalAlignment="Center"
                                                               Foreground="{DynamicResource {x:Static h:BrushKeys.ForegroundWhite}}"
                                                               Text="{Binding Value}"
                                                               ToolTip="{Binding Value1}" />

                                                    <Button Grid.Column="3"
                                                            h:Cattach.Icon="+"
                                                            h:Cattach.IconSize="18"
                                                            Foreground="{DynamicResource {x:Static h:BrushKeys.ForegroundWhite}}"
                                                            Style="{DynamicResource {x:Static h:ButtonKeys.Transparent}}" />


                                                    <Button x:Name="btn_close"
                                                            Grid.Column="4"
                                                            h:Cattach.IconSize="12"
                                                            h:Cattach.MouseOverForeground="{DynamicResource {x:Static h:BrushKeys.Red}}"
                                                            Foreground="{DynamicResource {x:Static h:BrushKeys.ForegroundWhite}}"
                                                            Style="{DynamicResource {x:Static h:ButtonKeys.Close}}" />
                                                </Grid>
                                            </HierarchicalDataTemplate>
                                        </TreeView.Resources>

                                        <h:Interaction.Triggers>
                                            <h:EventTrigger EventName="SelectedItemChanged">
                                                <h:InvokeCommandAction Command="{Binding RelayCommand}" PassEventArgsToCommand="True" />
                                            </h:EventTrigger>
                                        </h:Interaction.Triggers>
                                    </TreeView>

                                </DockPanel>

                            </GroupBox>

                            <GroupBox Padding="0"
                                      h:Cattach.CaptionForeground="{DynamicResource {x:Static h:BrushKeys.ForegroundWhite}}"
                                      Background="{DynamicResource {x:Static h:BrushKeys.AccentOpacity5}}"
                                      Header="属性"
                                      Style="{DynamicResource {x:Static h:GroupBoxKeys.Close}}">
                                <Grid Margin="0">
                                    <Grid.Resources>
                                        <DataTemplate DataType="{x:Type local:ServerViewModel}">
                                            <ScrollViewer>
                                                <StackPanel Margin="5,0" VerticalAlignment="Top" TextBlock.Foreground="{DynamicResource {x:Static h:BrushKeys.ForegroundWhite}}">
                                                    <h:Row Style="{DynamicResource {x:Static h:Row.Column1Key}}">
                                                        <TextBox h:Cattach.BackgroundColumn="1"
                                                                 h:Cattach.Title="名称"
                                                                 h:Cattach.TitleBackground="Transparent"
                                                                 h:Cattach.TitleForeground="{DynamicResource {x:Static h:BrushKeys.ForegroundWhite}}"
                                                                 DockPanel.Dock="Top"
                                                                 Style="{DynamicResource {x:Static h:TextBoxKeys.LabelClear}}"
                                                                 Text="{Binding Value, UpdateSourceTrigger=PropertyChanged}" />
                                                    </h:Row>

                                                    <h:Row Style="{DynamicResource {x:Static h:Row.Column1Key}}">
                                                        <ComboBox x:Name="cb_selecteserver"
                                                                  Margin="0"
                                                                  h:Cattach.BackgroundColumn="1"
                                                                  h:Cattach.Title="映射"
                                                                  h:Cattach.TitleBackground="Transparent"
                                                                  h:Cattach.TitleForeground="{DynamicResource {x:Static h:BrushKeys.ForegroundWhite}}"
                                                                  h:Cattach.Watermark="   请选择映射实际主机"
                                                                  Style="{DynamicResource {x:Static h:ComboBoxKeys.LabelSingle}}">
                                                            <ComboBox.ItemTemplate>
                                                                <DataTemplate>
                                                                    <DockPanel>
                                                                        <TextBlock Text="{Binding Value}" />
                                                                        <TextBlock Margin="10,0" Text="{Binding Value2}" />
                                                                    </DockPanel>
                                                                </DataTemplate>
                                                            </ComboBox.ItemTemplate>

                                                            <h:TestViewModel Value1="192.168.0.1" Value2="(34,145)" Value="  主机一" />
                                                            <h:TestViewModel Value1="192.168.0.2" Value2="(334,45)" Value="  主机二" />
                                                            <h:TestViewModel Value1="192.168.0.3" Value2="(234,435)" Value="  主机三" />
                                                            <h:TestViewModel Value1="192.168.0.4" Value2="(11,435)" Value="  主机四" />

                                                        </ComboBox>
                                                    </h:Row>

                                                    <h:Row Margin="{DynamicResource {x:Static h:ThicknessKeys.Margin_10_0}}" Style="{DynamicResource {x:Static h:Row.Column1Key}}">
                                                        <DockPanel>
                                                            <TextBlock Text="状态" />
                                                            <h:Ping Margin="10,0" IP="{Binding ElementName=cb_selecteserver, Path=SelectedItem.Value1}" RunningForegroundBrush="{DynamicResource {x:Static h:BrushKeys.ForegroundWhite}}" />
                                                        </DockPanel>
                                                    </h:Row>

                                                    <h:Row Margin="{DynamicResource {x:Static h:ThicknessKeys.Margin_10_0}}" Style="{DynamicResource {x:Static h:Row.Column1Key}}">
                                                        <TextBlock>
                                                            <Run Text="LatLngX" />
                                                            <Run Text="34.2393" />
                                                        </TextBlock>
                                                    </h:Row>

                                                    <h:Row Margin="{DynamicResource {x:Static h:ThicknessKeys.Margin_10_0}}" Style="{DynamicResource {x:Static h:Row.Column1Key}}">
                                                        <TextBlock>
                                                            <Run Text="LatLngY" />
                                                            <Run Text="108.085" />
                                                        </TextBlock>
                                                    </h:Row>

                                                    <h:Row Margin="{DynamicResource {x:Static h:ThicknessKeys.Margin_10_0}}" Style="{DynamicResource {x:Static h:Row.Column1Key}}">
                                                        <TextBlock>
                                                            <Run Text="设备数量" />
                                                            <Run Text="{Binding Children.Count, Mode=OneWay}" />
                                                        </TextBlock>
                                                    </h:Row>

                                                    <h:Row Margin="{DynamicResource {x:Static h:ThicknessKeys.Margin_10_0}}" Style="{DynamicResource {x:Static h:Row.Column4Key}}">
                                                        <TextBlock Text="偏移:" />
                                                        <Slider Grid.Column="1"
                                                                Grid.ColumnSpan="22"
                                                                Maximum="360"
                                                                Minimum="0"
                                                                Value="{Binding Double3, Mode=TwoWay}" />
                                                    </h:Row>

                                                    <h:Row Margin="{DynamicResource {x:Static h:ThicknessKeys.Margin_10_0}}" Style="{DynamicResource {x:Static h:Row.Column4Key}}">
                                                        <TextBlock Text="半径:" />
                                                        <Slider Grid.Column="1"
                                                                Grid.ColumnSpan="22"
                                                                Maximum="1500"
                                                                Minimum="0"
                                                                Value="{Binding Int2, Mode=TwoWay}" />
                                                    </h:Row>

                                                    <h:Row Margin="{DynamicResource {x:Static h:ThicknessKeys.Margin_10_0}}" Style="{DynamicResource {x:Static h:Row.Column4Key}}">
                                                        <TextBlock Text="结束角度:" />
                                                        <Slider Grid.Column="1"
                                                                Grid.ColumnSpan="22"
                                                                Maximum="360"
                                                                Minimum="0"
                                                                Value="{Binding Double2, Mode=TwoWay}" />
                                                    </h:Row>
                                                    <h:Row Margin="{DynamicResource {x:Static h:ThicknessKeys.Margin_10_0}}" Style="{DynamicResource {x:Static h:Row.Column4Key}}">
                                                        <TextBlock Text="起始角度:" />
                                                        <Slider Grid.Column="1"
                                                                Grid.ColumnSpan="22"
                                                                Maximum="360"
                                                                Minimum="0"
                                                                Value="{Binding Double1, Mode=TwoWay}" />
                                                    </h:Row>

                                                </StackPanel>
                                            </ScrollViewer>
                                        </DataTemplate>

                                        <DataTemplate DataType="{x:Type local:EquipmentViewModel}">
                                            <DockPanel>
                                                <Button Content="应用" DockPanel.Dock="Bottom" />
                                                <StackPanel VerticalAlignment="Top" TextBlock.Foreground="{DynamicResource {x:Static h:BrushKeys.ForegroundWhite}}">
                                                    <h:Row Style="{DynamicResource {x:Static h:Row.Column1Key}}">
                                                        <TextBox h:Cattach.BackgroundColumn="1"
                                                                 h:Cattach.Title="设备名称"
                                                                 h:Cattach.TitleBackground="Transparent"
                                                                 h:Cattach.TitleForeground="{DynamicResource {x:Static h:BrushKeys.ForegroundWhite}}"
                                                                 DockPanel.Dock="Top"
                                                                 Style="{DynamicResource {x:Static h:TextBoxKeys.LabelClear}}"
                                                                 Text="{Binding Value, UpdateSourceTrigger=PropertyChanged}" />
                                                    </h:Row>

                                                    <h:Row Style="{DynamicResource {x:Static h:Row.Column1Key}}">
                                                        <TextBox h:Cattach.BackgroundColumn="1"
                                                                 h:Cattach.Title="设备类型"
                                                                 h:Cattach.TitleBackground="Transparent"
                                                                 h:Cattach.TitleForeground="{DynamicResource {x:Static h:BrushKeys.ForegroundWhite}}"
                                                                 DockPanel.Dock="Top"
                                                                 Style="{DynamicResource {x:Static h:TextBoxKeys.LabelClear}}"
                                                                 Text="{Binding Value1}" />
                                                    </h:Row>

                                                    <h:Row Style="{DynamicResource {x:Static h:Row.Column1Key}}">
                                                        <TextBox h:Cattach.BackgroundColumn="1"
                                                                 h:Cattach.Title="信号类型"
                                                                 h:Cattach.TitleBackground="Transparent"
                                                                 h:Cattach.TitleForeground="{DynamicResource {x:Static h:BrushKeys.ForegroundWhite}}"
                                                                 DockPanel.Dock="Top"
                                                                 Style="{DynamicResource {x:Static h:TextBoxKeys.LabelClear}}"
                                                                 Text="{Binding Value2}" />
                                                    </h:Row>


                                                    <h:Row Style="{DynamicResource {x:Static h:Row.Column1Key}}">
                                                        <TextBox h:Cattach.BackgroundColumn="1"
                                                                 h:Cattach.Title="中心频率"
                                                                 h:Cattach.TitleBackground="Transparent"
                                                                 h:Cattach.TitleForeground="{DynamicResource {x:Static h:BrushKeys.ForegroundWhite}}"
                                                                 DockPanel.Dock="Top"
                                                                 Style="{DynamicResource {x:Static h:TextBoxKeys.LabelClear}}"
                                                                 Text="{Binding Double1}" />
                                                    </h:Row>

                                                    <h:Row Style="{DynamicResource {x:Static h:Row.Column1Key}}">
                                                        <TextBox h:Cattach.BackgroundColumn="1"
                                                                 h:Cattach.Title="输出频率"
                                                                 h:Cattach.TitleBackground="Transparent"
                                                                 h:Cattach.TitleForeground="{DynamicResource {x:Static h:BrushKeys.ForegroundWhite}}"
                                                                 DockPanel.Dock="Top"
                                                                 Style="{DynamicResource {x:Static h:TextBoxKeys.LabelClear}}"
                                                                 Text="{Binding Double2}" />
                                                    </h:Row>

                                                    <h:Row Style="{DynamicResource {x:Static h:Row.Column1Key}}">

                                                        <TextBox h:Cattach.BackgroundColumn="1"
                                                                 h:Cattach.Title="信号码速"
                                                                 h:Cattach.TitleBackground="Transparent"
                                                                 h:Cattach.TitleForeground="{DynamicResource {x:Static h:BrushKeys.ForegroundWhite}}"
                                                                 DockPanel.Dock="Top"
                                                                 Style="{DynamicResource {x:Static h:TextBoxKeys.LabelClear}}"
                                                                 Text="{Binding Double3}" />
                                                    </h:Row>
                                                    <h:Row Style="{DynamicResource {x:Static h:Row.Column1Key}}">
                                                        <TextBox h:Cattach.BackgroundColumn="1"
                                                                 h:Cattach.Title="调制频偏"
                                                                 h:Cattach.TitleBackground="Transparent"
                                                                 h:Cattach.TitleForeground="{DynamicResource {x:Static h:BrushKeys.ForegroundWhite}}"
                                                                 DockPanel.Dock="Top"
                                                                 Style="{DynamicResource {x:Static h:TextBoxKeys.LabelClear}}"
                                                                 Text="{Binding Double10}" />
                                                    </h:Row>
                                                    <h:Row Style="{DynamicResource {x:Static h:Row.Column1Key}}">
                                                        <TextBox h:Cattach.BackgroundColumn="1"
                                                                 h:Cattach.Title="调制深度"
                                                                 h:Cattach.TitleBackground="Transparent"
                                                                 h:Cattach.TitleForeground="{DynamicResource {x:Static h:BrushKeys.ForegroundWhite}}"
                                                                 DockPanel.Dock="Top"
                                                                 Style="{DynamicResource {x:Static h:TextBoxKeys.LabelClear}}"
                                                                 Text="{Binding Double12}" />
                                                    </h:Row>
                                                </StackPanel>

                                            </DockPanel>
                                        </DataTemplate>

                                        <DataTemplate DataType="{x:Type local:TaskViewModel}">
                                            <StackPanel VerticalAlignment="Top" TextBlock.Foreground="{DynamicResource {x:Static h:BrushKeys.ForegroundWhite}}">

                                                <h:Row Style="{DynamicResource {x:Static h:Row.Column1Key}}">
                                                    <TextBox h:Cattach.Title="任务名称"
                                                             h:Cattach.TitleForeground="{DynamicResource {x:Static h:BrushKeys.ForegroundWhite}}"
                                                             DockPanel.Dock="Top"
                                                             Style="{DynamicResource {x:Static h:TextBoxKeys.LabelClear}}"
                                                             Text="{Binding Value, UpdateSourceTrigger=PropertyChanged}" />
                                                </h:Row>

                                                <h:Row Style="{DynamicResource {x:Static h:Row.Column1Key}}">
                                                    <TextBox h:Cattach.Title="数量"
                                                             h:Cattach.TitleForeground="{DynamicResource {x:Static h:BrushKeys.ForegroundWhite}}"
                                                             DockPanel.Dock="Top"
                                                             IsReadOnly="True"
                                                             Style="{DynamicResource {x:Static h:TextBoxKeys.LabelClear}}"
                                                             Text="{Binding Children[0].Children.Count, Mode=OneWay}" />
                                                </h:Row>

                                                <h:Row Style="{DynamicResource {x:Static h:Row.Column1Key}}">
                                                    <TextBox h:Cattach.Title="设备数量"
                                                             h:Cattach.TitleForeground="{DynamicResource {x:Static h:BrushKeys.ForegroundWhite}}"
                                                             DockPanel.Dock="Top"
                                                             Style="{DynamicResource {x:Static h:TextBoxKeys.LabelClear}}"
                                                             Text="{Binding Children[1].Children.Count, Mode=OneWay}" />
                                                </h:Row>
                                            </StackPanel>
                                        </DataTemplate>

                                        <DataTemplate DataType="{x:Type local:ServerGroupViewModel}">
                                            <StackPanel VerticalAlignment="Top" TextBlock.Foreground="{DynamicResource {x:Static h:BrushKeys.ForegroundWhite}}">
                                                <h:Row Style="{DynamicResource {x:Static h:Row.Column1Key}}">
                                                    <TextBox h:Cattach.Title="数量"
                                                             h:Cattach.TitleForeground="{DynamicResource {x:Static h:BrushKeys.ForegroundWhite}}"
                                                             DockPanel.Dock="Top"
                                                             IsReadOnly="True"
                                                             Style="{DynamicResource {x:Static h:TextBoxKeys.LabelClear}}"
                                                             Text="{Binding Children[0].Children.Count, Mode=OneWay}" />
                                                </h:Row>
                                            </StackPanel>
                                        </DataTemplate>

                                        <DataTemplate DataType="{x:Type local:EquipmentGroupViewModel}">
                                            <StackPanel VerticalAlignment="Top" TextBlock.Foreground="{DynamicResource {x:Static h:BrushKeys.ForegroundWhite}}">
                                                <h:Row Style="{DynamicResource {x:Static h:Row.Column1Key}}">
                                                    <TextBox h:Cattach.Title="设备数量"
                                                             h:Cattach.TitleForeground="{DynamicResource {x:Static h:BrushKeys.ForegroundWhite}}"
                                                             DockPanel.Dock="Top"
                                                             IsReadOnly="True"
                                                             Style="{DynamicResource {x:Static h:TextBoxKeys.LabelClear}}"
                                                             Text="{Binding Children[0].Children.Count, Mode=OneWay}" />
                                                </h:Row>
                                            </StackPanel>
                                        </DataTemplate>

                                        <DataTemplate DataType="{x:Type h:TestViewModel}">
                                            <StackPanel VerticalAlignment="Top" TextBlock.Foreground="{DynamicResource {x:Static h:BrushKeys.ForegroundWhite}}">

                                                <h:Row Style="{DynamicResource {x:Static h:Row.Column1Key}}">
                                                    <TextBox h:Cattach.Title="名称"
                                                             h:Cattach.TitleForeground="{DynamicResource {x:Static h:BrushKeys.ForegroundWhite}}"
                                                             DockPanel.Dock="Top"
                                                             Style="{DynamicResource {x:Static h:TextBoxKeys.LabelClear}}"
                                                             Text="{Binding Value, UpdateSourceTrigger=PropertyChanged}" />
                                                </h:Row>

                                                <h:Row Style="{DynamicResource {x:Static h:Row.Column1Key}}">
                                                    <TextBox h:Cattach.Title="类型"
                                                             h:Cattach.TitleForeground="{DynamicResource {x:Static h:BrushKeys.ForegroundWhite}}"
                                                             DockPanel.Dock="Top"
                                                             Style="{DynamicResource {x:Static h:TextBoxKeys.LabelClear}}"
                                                             Text="{Binding Value1}" />
                                                </h:Row>

                                                <h:Row Style="{DynamicResource {x:Static h:Row.Column1Key}}">
                                                    <TextBox h:Cattach.Title="信号类型"
                                                             h:Cattach.TitleForeground="{DynamicResource {x:Static h:BrushKeys.ForegroundWhite}}"
                                                             DockPanel.Dock="Top"
                                                             Style="{DynamicResource {x:Static h:TextBoxKeys.LabelClear}}"
                                                             Text="{Binding Value2}" />
                                                </h:Row>

                                            </StackPanel>
                                        </DataTemplate>
                                    </Grid.Resources>

                                    <ContentControl Content="{Binding SelectedNode}" />

                                </Grid>
                            </GroupBox>
                        </UniformGrid>
                    </Grid>
                </h:Drawer>

                <h:Drawer Grid.ColumnSpan="22"
                          Padding="0"
                          HorizontalAlignment="Left"
                          h:Cattach.Icon="模"
                          h:Cattach.IconMargin="0 100 0 0"
                          Background="Transparent"
                          Header="模板列表"
                          IsExpanded="True"
                          Style="{DynamicResource {x:Static h:Drawer.LeftClearKey}}">
                    <h:TransitionService.VisibleActions>
                        <h:TransitionCollection>
                            <h:TranslateTransition StartPoint="-300,0" EndPoint="-200,0" />
                        </h:TransitionCollection>
                    </h:TransitionService.VisibleActions>

                    <GroupBox Width="350"
                              Padding="0"
                              h:Cattach.CaptionForeground="{DynamicResource {x:Static h:BrushKeys.ForegroundWhite}}"
                              Background="{DynamicResource {x:Static h:BrushKeys.AccentOpacity5}}"
                              Header="发生器模板"
                              Style="{DynamicResource {x:Static h:GroupBoxKeys.Close}}">

                        <DockPanel>
                            <h:Row DockPanel.Dock="Top">
                                <TextBox Grid.ColumnSpan="22"
                                         Margin="5,0"
                                         h:Cattach.Icon="&#xe787;"
                                         h:Cattach.Watermark="请输入筛选条件"
                                         Style="{DynamicResource {x:Static h:TextBoxKeys.ClearSingle}}" />
                            </h:Row>

                            <ListBox Grid.Row="1"
                                     h:Cattach.ItemBackground="Transparent"
                                     h:Cattach.MouseOverBackground="{DynamicResource {x:Static h:BrushKeys.WhiteOpactiy2}}"
                                     h:Cattach.SelectBackground="{DynamicResource {x:Static h:BrushKeys.WhiteOpactiy4}}"
                                     AllowDrop="True"
                                     Background="Transparent"
                                     ItemsSource="{Binding Servers}"
                                     SelectedItem="{Binding SelectedServer}"
                                     Style="{DynamicResource {x:Static h:ListBoxKeys.AllowDrag}}">
                                <h:Interaction.Behaviors>
                                    <!--<h:ListDragBlendBehavior DragGroup="Server" DragDropEffects="Copy"/>-->
                                    <!--<h:ListDropBlendBehavior/>-->
                                </h:Interaction.Behaviors>

                                <ListBox.ContextMenu>
                                    <ContextMenu>
                                        <MenuItem CommandParameter="新建任务" Header="添加" IsEnabled="True" />
                                        <MenuItem CommandParameter="新建任务" Header="添加设备" IsEnabled="True" />
                                        <MenuItem Header="删除" IsEnabled="True" />
                                        <Separator Style="{DynamicResource {x:Static h:SeparatorKeys.Default}}" />
                                        <MenuItem Header="信号检测" IsEnabled="True" />
                                        <MenuItem Header="强度调整" IsEnabled="True" />
                                        <MenuItem Header="关闭输出" IsEnabled="True" />
                                        <MenuItem Header="显示/隐藏" IsEnabled="True" />
                                    </ContextMenu>
                                </ListBox.ContextMenu>

                                <ListBox.GroupStyle>
                                    <GroupStyle ContainerStyle="{StaticResource S.GroupItem.Transparent}">
                                        <GroupStyle.Panel>
                                            <ItemsPanelTemplate>
                                                <DataGridRowsPresenter />
                                            </ItemsPanelTemplate>
                                        </GroupStyle.Panel>
                                    </GroupStyle>
                                </ListBox.GroupStyle>

                                <ListBox.ItemTemplate>
                                    <DataTemplate DataType="{x:Type h:TestViewModel}">
                                        <Grid x:Name="grid"
                                              Width="{Binding RelativeSource={RelativeSource AncestorType=ListBox}, Path=ActualWidth}"
                                              HorizontalAlignment="Left"
                                              TextBlock.Foreground="{Binding RelativeSource={RelativeSource AncestorType=ListBoxItem}, Path=Foreground}">
                                            <Grid.RowDefinitions>
                                                <RowDefinition />
                                            </Grid.RowDefinitions>

                                            <Grid.ColumnDefinitions>
                                                <ColumnDefinition Width="Auto" />
                                                <ColumnDefinition />
                                                <ColumnDefinition />
                                                <ColumnDefinition Width="Auto" />
                                            </Grid.ColumnDefinitions>

                                            <TextBlock Grid.Row="1"
                                                       Grid.Column="1"
                                                       VerticalAlignment="Center"
                                                       Foreground="{DynamicResource {x:Static h:BrushKeys.ForegroundWhite}}"
                                                       Text="{Binding Value}"
                                                       ToolTip="{Binding Value1}" />

                                            <TextBlock Grid.Row="1"
                                                       Grid.Column="2"
                                                       Margin="15,0,0,0"
                                                       VerticalAlignment="Center"
                                                       Foreground="{DynamicResource {x:Static h:BrushKeys.ForegroundWhite}}"
                                                       Text="{Binding Value1}"
                                                       ToolTip="{Binding Value1}" />

                                            <Button x:Name="btn_close"
                                                    Grid.Column="3"
                                                    Width="Auto"
                                                    Margin="25,0"
                                                    VerticalAlignment="Center"
                                                    Foreground="{DynamicResource {x:Static h:BrushKeys.ForegroundWhite}}"
                                                    Style="{DynamicResource {x:Static h:ButtonKeys.Close}}" />

                                        </Grid>
                                        <DataTemplate.Triggers>
                                            <DataTrigger Binding="{Binding RelativeSource={RelativeSource AncestorType=ListBoxItem}, Path=IsMouseOver}" Value="True">
                                                <Setter TargetName="btn_close" Property="Visibility" Value="Visible" />
                                            </DataTrigger>
                                        </DataTemplate.Triggers>
                                    </DataTemplate>
                                </ListBox.ItemTemplate>
                            </ListBox>
                        </DockPanel>
                    </GroupBox>
                </h:Drawer>

            </Grid>

        </DockPanel>

        <!--<Border Height="{DynamicResource {x:Static h:SystemKeys.RowHeight}}"
                Margin="300,0"
                VerticalAlignment="Bottom"
                Background="Transparent">
            <h:Interaction.Triggers>
                <h:EventTrigger EventName="MouseEnter">
                    <h:ChangePropertyAction PropertyName="StateVisble" TargetObject="{Binding}" Value="True" />
                </h:EventTrigger>
            </h:Interaction.Triggers>
        </Border>-->



        <UniformGrid Width="500"
                     Height="400"
                     Margin="250,30,0,0"
                     HorizontalAlignment="Left"
                     VerticalAlignment="Top"
                     h:TransitionService.IsVisible="{Binding ElementName=tb_signal, Path=IsChecked}"
                     Rows="2">
            <h:TransitionService.VisibleActions>
                <h:TransitionCollection>
                    <h:TranslateTransition StartPoint="0,-30" EndPoint="0,-30" />
                </h:TransitionCollection>
            </h:TransitionService.VisibleActions>

            <GroupBox Header="信号控制">
                <ItemsControl>
                    <h:Row>
                        <DockPanel Grid.ColumnSpan="22">
                            <TextBlock Margin="10,0" Text="信号一" />
                            <Slider Style="{DynamicResource {x:Static h:SliderKeys.Value}}" Value="56" />
                        </DockPanel>
                    </h:Row>

                    <h:Row>
                        <DockPanel Grid.ColumnSpan="22">
                            <TextBlock Margin="10,0" Text="信号二" />
                            <Slider Style="{DynamicResource {x:Static h:SliderKeys.Value}}" Value="85" />
                        </DockPanel>
                    </h:Row>
                    <h:Row>
                        <DockPanel Grid.ColumnSpan="22">
                            <TextBlock Margin="10,0" Text="信号三" />
                            <Slider Style="{DynamicResource {x:Static h:SliderKeys.Value}}" Value="12" />
                        </DockPanel>
                    </h:Row>
                </ItemsControl>
            </GroupBox>
            <GroupBox Header="强度开关">
                <ItemsControl>
                    <h:Row>
                        <DockPanel Grid.ColumnSpan="22">
                            <TextBlock Margin="10,0" Text="强度一" />
                            <h:SwitchToggleButton HorizontalAlignment="Left" IsChecked="True" />
                        </DockPanel>
                    </h:Row>

                    <h:Row>
                        <DockPanel Grid.ColumnSpan="22">
                            <TextBlock Margin="10,0" Text="强度二" />
                            <h:SwitchToggleButton HorizontalAlignment="Left" />
                        </DockPanel>
                    </h:Row>
                    <h:Row>
                        <DockPanel Grid.ColumnSpan="22">
                            <TextBlock Margin="10,0" Text="强度三" />
                            <h:SwitchToggleButton HorizontalAlignment="Left" IsChecked="True" />
                        </DockPanel>
                    </h:Row>
                </ItemsControl>
            </GroupBox>
        </UniformGrid>
    </Grid>

</h:MenuWindowBase>
