<UserControl
    x:Class="MachineVision.Views.NccMatchView"
    xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
    xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
    xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
    xmlns:halconView="clr-namespace:MachineVision.Shared2;assembly=MachineVision.Shared2"
    xmlns:local="clr-namespace:MachineVision.Views"
    xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
    xmlns:md="http://materialdesigninxaml.net/winfx/xaml/themes"
    xmlns:viewmodels="clr-namespace:MachineVision.ViewModels"
    d:Background="{DynamicResource MaterialDesign.Brush.Background}"
    d:DataContext="{d:DesignInstance viewmodels:NccMatchViewModel}"
    d:DesignHeight="450"
    d:DesignWidth="800"
    mc:Ignorable="d">
    <Grid>
        <Grid.RowDefinitions>
            <RowDefinition Height="auto" />
            <RowDefinition Height="*" />
        </Grid.RowDefinitions>

        <Grid>
            <Grid.ColumnDefinitions>
                <ColumnDefinition />
                <ColumnDefinition />
            </Grid.ColumnDefinitions>
            <!-- 左半边标题 -->
            <StackPanel
                Grid.Column="0"
                Margin="20,10">
                <TextBlock
                    FontSize="17"
                    FontWeight="Bold"
                    Foreground="snow"
                    Text="find_ncc_model (Operator)" />
                <TextBlock
                    Margin="0,5"
                    FontSize="14"
                    Foreground="Snow"
                    Text=" Find the best matches of an NCC model in an image." />
            </StackPanel>

            <!-- 右半边匹配结果显示 -->
            <StackPanel
                Grid.Column="1"
                Margin="20">
                <StackPanel Orientation="Horizontal">
                    <TextBlock
                        VerticalAlignment="Center"
                        FontSize="16"
                        Foreground="Snow"
                        Text="匹配到的个数:" />
                    <TextBox
                        MinWidth="80"
                        Margin="10,0"
                        VerticalAlignment="Center"
                        FontSize="16"
                        Foreground="Snow"
                        IsReadOnly="True"
                        Text="{Binding TeamplateService.MatchResult.MatchCount, Mode=OneWay}" />
                </StackPanel>

                <StackPanel Orientation="Horizontal">
                    <TextBlock
                        VerticalAlignment="Center"
                        FontSize="16"
                        Foreground="Snow"
                        Text="匹配耗时(ms):" />
                    <TextBox
                        MinWidth="80"
                        Margin="10,0"
                        VerticalAlignment="Center"
                        FontSize="16"
                        Foreground="Snow"
                        IsReadOnly="True"
                        Text="{Binding TeamplateService.MatchResult.TimeSpan, Mode=OneWay}" />
                </StackPanel>
            </StackPanel>
        </Grid>

        <TabControl
            Grid.Row="1"
            HorizontalContentAlignment="Left"
            Style="{StaticResource MaterialDesignTabControlBase}">

            <TabItem Header="参数说明">

                <TextBlock />
            </TabItem>

            <TabItem Header="关联算子">
                <TextBlock />
            </TabItem>

            <TabItem Header="代码示例">

                <TextBlock />
            </TabItem>

            <TabItem Header="开始使用">
                <Grid>
                    <Grid.ColumnDefinitions>
                        <ColumnDefinition Width="1.8*" />
                        <ColumnDefinition />
                    </Grid.ColumnDefinitions>

                    <!-- 左边 -->
                    <Grid>
                        <Grid.RowDefinitions>
                            <RowDefinition Height="2.2*" />
                            <RowDefinition />
                        </Grid.RowDefinitions>

                        <halconView:HalconDrawShape
                            Grid.Row="0"
                            Background="Black"
                            DrawObjectInfos="{Binding DrawObjectInfos, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}"
                            EditImage="{Binding EditImage, Mode=OneWayToSource, UpdateSourceTrigger=PropertyChanged}"
                            MaskObject="{Binding MaskObject, Mode=OneWayToSource, UpdateSourceTrigger=PropertyChanged}"
                            MatchResult="{Binding MatchResult, Mode=OneWay, UpdateSourceTrigger=PropertyChanged}" />

                        <DataGrid
                            Grid.Row="1"
                            AutoGenerateColumns="False"
                            IsReadOnly="True"
                            ItemsSource="{Binding TeamplateService.MatchResult.Results}">
                            <DataGrid.Columns>
                                <DataGridTextColumn
                                    Width="*"
                                    Binding="{Binding Index}"
                                    Header="序号" />
                                <DataGridTextColumn
                                    Width="*"
                                    Binding="{Binding Row}"
                                    Header="X坐标" />
                                <DataGridTextColumn
                                    Width="*"
                                    Binding="{Binding Cloumn}"
                                    Header="Y坐标" />
                                <DataGridTextColumn
                                    Width="*"
                                    Binding="{Binding Angle}"
                                    Header="角度" />
                                <DataGridTextColumn
                                    Width="*"
                                    Binding="{Binding Score}"
                                    Header="分数" />
                            </DataGrid.Columns>
                        </DataGrid>
                    </Grid>

                    <!-- 右边 -->
                    <TabControl
                        Grid.Column="1"
                        HorizontalContentAlignment="Left">
                        <TabItem Header="参数设置">
                            <ScrollViewer VerticalScrollBarVisibility="Hidden">
                                <StackPanel>

                                    <!-- ROI范围 -->
                                    <Expander>
                                        <Expander.Header>
                                            <TextBlock
                                                Margin="-16,0"
                                                FontSize="16"
                                                FontWeight="Bold"
                                                Foreground="White"
                                                Text="ROI范围" />
                                        </Expander.Header>
                                        <Expander.Content>
                                            <StackPanel>
                                                <Button
                                                    Margin="20"
                                                    Command="{Binding SetROICommand}"
                                                    Content="设定ROI范围" />
                                            </StackPanel>
                                        </Expander.Content>
                                    </Expander>

                                    <!-- 创建参数 -->
                                    <Expander>
                                        <Expander.Header>
                                            <TextBlock
                                                Margin="-16,0"
                                                FontSize="16"
                                                FontWeight="Bold"
                                                Foreground="White"
                                                Text="创建参数" />
                                        </Expander.Header>
                                        <Expander.Content>
                                            <StackPanel>

                                                <!-- 金字塔层数 -->
                                                <TextBlock
                                                    Margin="20,10,0,0"
                                                    FontSize="14"
                                                    Foreground="Snow"
                                                    Text="NumLevels (input_control)(金字塔层数)" />
                                                <ComboBox
                                                    Margin="20,5"
                                                    Padding="10"
                                                    HorizontalContentAlignment="Center"
                                                    BorderThickness="2"
                                                    Foreground="Snow"
                                                    Style="{StaticResource MaterialDesignOutlinedComboBox}"
                                                    Text="{Binding TeamplateService.CreateParamter.NumLevels}">
                                                    <ComboBoxItem>0</ComboBoxItem>
                                                    <ComboBoxItem>1</ComboBoxItem>
                                                    <ComboBoxItem>2</ComboBoxItem>
                                                    <ComboBoxItem>3</ComboBoxItem>
                                                    <ComboBoxItem>4</ComboBoxItem>
                                                    <ComboBoxItem>5</ComboBoxItem>
                                                    <ComboBoxItem>6</ComboBoxItem>
                                                    <ComboBoxItem>7</ComboBoxItem>
                                                    <ComboBoxItem>8</ComboBoxItem>
                                                    <ComboBoxItem>9</ComboBoxItem>
                                                    <ComboBoxItem>10</ComboBoxItem>
                                                </ComboBox>

                                                <!-- 起始角度 -->
                                                <TextBlock
                                                    Margin="20,10,0,0"
                                                    FontSize="14"
                                                    Foreground="Snow"
                                                    Text="AngleStart (input_control)(起始角度)" />
                                                <TextBox
                                                    Margin="20,10"
                                                    md:HintAssist.Hint="请输入参数"
                                                    BorderThickness="2"
                                                    FontSize="16"
                                                    Foreground="Snow"
                                                    Text="{Binding TeamplateService.CreateParamter.AngleStart, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}"
                                                    TextAlignment="Center" />


                                                <!-- 终止角度 -->
                                                <TextBlock
                                                    Margin="20,10,0,0"
                                                    FontSize="14"
                                                    Foreground="Snow"
                                                    Text="AngleExtent (input_control)(最终角度) " />
                                                <TextBox
                                                    Margin="20,10"
                                                    md:HintAssist.Hint="请输入参数"
                                                    BorderThickness="2"
                                                    FontSize="16"
                                                    Foreground="Snow"
                                                    Text="{Binding TeamplateService.CreateParamter.AngleExtent}"
                                                    TextAlignment="Center" />

                                                <!-- 角度步长 -->
                                                <TextBlock
                                                    Margin="20,10,0,0"
                                                    FontSize="14"
                                                    Foreground="Snow"
                                                    Text="AngleStep (input_control)(角度步长)" />
                                                <ComboBox
                                                    Margin="20,5"
                                                    Padding="10"
                                                    HorizontalContentAlignment="Center"
                                                    BorderThickness="2"
                                                    Foreground="Snow"
                                                    Style="{StaticResource MaterialDesignOutlinedComboBox}"
                                                    Text="{Binding TeamplateService.CreateParamter.AngleStep}">
                                                    <ComboBoxItem>auto</ComboBoxItem>
                                                    <ComboBoxItem>0.0175</ComboBoxItem>
                                                    <ComboBoxItem>0.0349</ComboBoxItem>
                                                    <ComboBoxItem>0.0524</ComboBoxItem>
                                                    <ComboBoxItem>0.0698</ComboBoxItem>
                                                    <ComboBoxItem>0.0873</ComboBoxItem>
                                                </ComboBox>

                                             

                                                <!-- 度量方式 -->
                                                <TextBlock
                                                    Margin="20,10,0,0"
                                                    FontSize="14"
                                                    Foreground="Snow"
                                                    Text="Metric (input_control)(度量方式)" />
                                                <ComboBox
                                                    Margin="20,5"
                                                    Padding="10"
                                                    HorizontalContentAlignment="Center"
                                                    BorderThickness="2"
                                                    Foreground="Snow"
                                                    Style="{StaticResource MaterialDesignOutlinedComboBox}"
                                                    Text="{Binding TeamplateService.CreateParamter.Metric}">
                                                    <ComboBoxItem>ignore_color_polarity</ComboBoxItem>
                                                    <ComboBoxItem>ignore_global_polarity</ComboBoxItem>
                                                    <ComboBoxItem>ignore_local_polarity</ComboBoxItem>
                                                    <ComboBoxItem>use_polarity</ComboBoxItem>
                                                </ComboBox>

                                                                                             

                                                <Button
                                                    Margin="20"
                                                    Command="{Binding CreateTeamplateCommand}"
                                                    Content="创建模板" />
                                            </StackPanel>
                                        </Expander.Content>
                                    </Expander>

                                    <!-- 查找参数 -->
                                    <Expander>
                                        <Expander.Header>
                                            <TextBlock
                                                Margin="-16,0"
                                                FontSize="16"
                                                FontWeight="Bold"
                                                Foreground="White"
                                                Text="匹配参数" />
                                        </Expander.Header>
                                        <Expander.Content>
                                            <StackPanel>


                                                <!-- 起始角度 -->
                                                <TextBlock
                                                    Margin="20,10,0,0"
                                                    FontSize="14"
                                                    Foreground="Snow"
                                                    Text="AngleStart (input_control)(起始角度)" />
                                                <TextBox
                                                    Margin="20,10"
                                                    md:HintAssist.Hint="请输入参数"
                                                    BorderThickness="2"
                                                    FontSize="16"
                                                    Foreground="Snow"
                                                    Text="{Binding TeamplateService.FindParamter.AngleStart}"
                                                    TextAlignment="Center" />

                                                <!-- 终止角度 -->
                                                <TextBlock
                                                    Margin="20,10,0,0"
                                                    FontSize="14"
                                                    Foreground="Snow"
                                                    Text="AngleExtent (input_control)(最终角度) " />
                                                <TextBox
                                                    Margin="20,10"
                                                    md:HintAssist.Hint="请输入参数"
                                                    BorderThickness="2"
                                                    FontSize="16"
                                                    Foreground="Snow"
                                                    Text="{Binding TeamplateService.FindParamter.AngleExtent}"
                                                    TextAlignment="Center" />

                                                <!-- 最小分数 -->
                                                <TextBlock
                                                    Margin="20,10,0,0"
                                                    FontSize="14"
                                                    Foreground="Snow"
                                                    Text="MinScore (input_control)(最小分数)" />
                                                <TextBox
                                                    Margin="20,10"
                                                    md:HintAssist.Hint="请输入参数"
                                                    BorderThickness="2"
                                                    FontSize="16"
                                                    Foreground="Snow"
                                                    Text="{Binding TeamplateService.FindParamter.MinScore}"
                                                    TextAlignment="Center" />

                                                <!-- 匹配数量 -->
                                                <TextBlock
                                                    Margin="20,10,0,0"
                                                    FontSize="14"
                                                    Foreground="Snow"
                                                    Text="NumMatches (input_control)(匹配个数)" />
                                                <TextBox
                                                    Margin="20,10"
                                                    md:HintAssist.Hint="请输入参数"
                                                    BorderThickness="2"
                                                    FontSize="16"
                                                    Foreground="Snow"
                                                    Text="{Binding TeamplateService.FindParamter.NumMatches}"
                                                    TextAlignment="Center" />

                                                <!-- 最大重叠率 -->
                                                <TextBlock
                                                    Margin="20,10,0,0"
                                                    FontSize="14"
                                                    Foreground="Snow"
                                                    Text="MaxOverlap (input_control)(最大重叠率)" />
                                                <TextBox
                                                    Margin="20,10"
                                                    md:HintAssist.Hint="请输入参数"
                                                    BorderThickness="2"
                                                    FontSize="16"
                                                    Foreground="Snow"
                                                    Text="{Binding TeamplateService.FindParamter.MaxOverlap}"
                                                    TextAlignment="Center" />

                                                <!-- 子像素精度 -->
                                                <TextBlock
                                                    Margin="20,10,0,0"
                                                    FontSize="14"
                                                    Foreground="Snow"
                                                    Text="SubPixel (input_control)(子像素精度)" />
                                                <ComboBox
                                                    Margin="20,5"
                                                    Padding="10"
                                                    HorizontalContentAlignment="Center"
                                                    BorderThickness="2"
                                                    Foreground="Snow"
                                                    Style="{StaticResource MaterialDesignOutlinedComboBox}"
                                                    Text="{Binding TeamplateService.FindParamter.SubPixel}">
                                                    <ComboBoxItem>true</ComboBoxItem>
                                                    <ComboBoxItem>false</ComboBoxItem>
                                      
                                                </ComboBox>

                                                <!-- 金字塔级别 -->
                                                <TextBlock
                                                    Margin="20,10,0,0"
                                                    FontSize="14"
                                                    Foreground="Snow"
                                                    Text="NumLevels (input_control)(金字塔层数)" />
                                                <ComboBox
                                                    Margin="20,5"
                                                    Padding="10"
                                                    HorizontalContentAlignment="Center"
                                                    BorderThickness="2"
                                                    Foreground="Snow"
                                                    Style="{StaticResource MaterialDesignOutlinedComboBox}"
                                                    Text="{Binding TeamplateService.FindParamter.NumLevels}">
                                                    <ComboBoxItem>0</ComboBoxItem>
                                                    <ComboBoxItem>1</ComboBoxItem>
                                                    <ComboBoxItem>2</ComboBoxItem>
                                                    <ComboBoxItem>3</ComboBoxItem>
                                                    <ComboBoxItem>4</ComboBoxItem>
                                                    <ComboBoxItem>5</ComboBoxItem>
                                                    <ComboBoxItem>6</ComboBoxItem>
                                                    <ComboBoxItem>7</ComboBoxItem>
                                                    <ComboBoxItem>8</ComboBoxItem>
                                                    <ComboBoxItem>9</ComboBoxItem>
                                                    <ComboBoxItem>10</ComboBoxItem>
                                                </ComboBox>

                                             


                                                <Button
                                                    Margin="20"
                                                    Command="{Binding FindTeamplateCommand}"
                                                    Content="查找匹配模板" />
                                            </StackPanel>
                                        </Expander.Content>
                                    </Expander>
                                </StackPanel>



                                <!-- 创建参数 -->

                            </ScrollViewer>
                        </TabItem>
                        <TabItem Header="结果展示">
                            <StackPanel>

                                <DockPanel LastChildFill="False">
                                    <TextBlock
                                        Margin="5,0"
                                        VerticalAlignment="Center"
                                        DockPanel.Dock="Left"
                                        FontSize="19"
                                        Foreground="snow"
                                        Text="显示文本" />
                                    <ToggleButton
                                        Width="80"
                                        Margin="0,10"
                                        DockPanel.Dock="Right"
                                        IsChecked="{Binding MatchResult.IsShowText, FallbackValue=true}" />
                                </DockPanel>

                                <DockPanel LastChildFill="False">
                                    <TextBlock
                                        Margin="5,0"
                                        VerticalAlignment="Center"
                                        DockPanel.Dock="Left"
                                        FontSize="19"
                                        Foreground="snow"
                                        Text="显示中心点" />
                                    <ToggleButton
                                        Width="80"
                                        Margin="0,10"
                                        DockPanel.Dock="Right"
                                        IsChecked="{Binding MatchResult.IsShowCenter, FallbackValue=true}" />
                                </DockPanel>

                                <DockPanel LastChildFill="False">
                                    <TextBlock
                                        Margin="5,0"
                                        VerticalAlignment="Center"
                                        DockPanel.Dock="Left"
                                        FontSize="19"
                                        Foreground="snow"
                                        Text="显示检测范围" />
                                    <ToggleButton
                                        Width="80"
                                        Margin="0,10"
                                        DockPanel.Dock="Right"
                                        IsChecked="{Binding MatchResult.IsShowMatchRegion, FallbackValue=true}" />
                                </DockPanel>
                            </StackPanel>
                        </TabItem>
                    </TabControl>
                </Grid>

            </TabItem>

        </TabControl>

    </Grid>
</UserControl>
